{"mappings":"qhBAAA,IAAAA,EAAAC,EAAA,S,oDAOA,MAAMC,EAAgBC,SAASC,cAAc,gBACvCC,EAAaF,SAASC,cAAc,YACpCE,EAAcH,SAASC,cAAc,cAErCG,EAASJ,SAASC,cAAc,aAGtC,IAAII,EAAc,EACdC,EAAY,EACZC,EAAc,GAClB,MAAMC,EAAyB,IAAIC,EAAAC,GAAJ,CAAmB,aAAc,CAC9DC,aAAc,MACdC,aAAc,MAGhB,IAKIC,EAAW,IAAIC,sBAoEnB,SAA8BC,EAASC,GACrCD,EAAQE,SAAQC,IACVA,EAAMC,iBACRd,GAAe,GACf,EAAAe,EAAAC,aAAYd,EAAaF,EAtFd,IAuFRiB,MAAKC,IACJC,EAAcD,EAAKE,MACnBjB,EAAuBkB,UAEnBrB,IAAgBsB,KAAKC,KAAKL,EAAKM,UA3F5B,MA4FL1B,EAAY2B,UAAUC,IAAI,aAC1BlC,EAAAmC,OAAOC,QACL,8DAEFjB,EAASkB,UAAU9B,KAIrB,EAAA+B,EAAAC,cAAalC,EAAW,IAEzBmC,OAAMC,GAAOC,QAAQC,IAAIF,K,MA7FpB,CACZG,KAAM,KACNC,WAAY,QACZC,UAAW,IA+Fb,SAASnB,EAAcoB,GACrB1C,EAAW2C,mBAAmB,aAAa,EAAAC,EAAAC,cAAaH,G,CA5F1D7C,EAAciD,iBAAiB,UAE/B,SAAwBC,GAMtB,GALAA,EAAMC,iBA4FR,WACEhD,EAAWiD,UAAY,GACvB9C,EAAc,C,CA5Fd+C,GAEA7C,EAAc0C,EAAMI,OAAOC,SAASC,YAAYC,MAAMC,QACjDlD,EACH,OAAOV,EAAAmC,OAAO0B,QAAQ,0BAGxB,EAAAtC,EAAAC,aAAYd,EAAaF,EA5BV,IA6BZiB,MAAKC,IACJ,IAAKA,EAAKE,KAAKkC,QAAUpC,EAAKM,UAE5B,OADA1B,EAAY2B,UAAUC,IAAI,aACnBlC,EAAAmC,OAAO0B,QACZ,4EAGJpD,EAAYiB,EAAKM,UACG,IAAhBxB,GACFR,EAAAmC,OAAO4B,QAAQ,oBAAoBtD,aAGrCkB,EAAcD,EAAKE,MACnBjB,EAAuBkB,UACvBb,EAASgD,QAAQzD,GAEbmB,EAAKE,KAAKkC,SAAWpC,EAAKM,YAE5B1B,EAAY2B,UAAUC,IAAI,aAC1BlC,EAAAmC,OAAOC,QACL,+DAGAV,EAAKE,KAAKkC,OAASpC,EAAKM,SAAS,IAItCQ,OAAMC,GAAOC,QAAQC,IAAIF,I","sources":["src/02-index.js"],"sourcesContent":["import { Notify } from 'notiflix/build/notiflix-notify-aio';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { fetchImages } from './js/pixabayAPI';\nimport { createMarkup } from './js/createCards';\nimport { smoothScroll } from './js/setScroll';\n\nconst formSearchRef = document.querySelector('.search-form');\nconst galleryRef = document.querySelector('.gallery');\nconst loadMoreRef = document.querySelector('.load-more');\n// + for infiniti scroll\nconst target = document.querySelector('.js-guard');\n\nconst PER_PAGE = 40;\nlet currentPage = 1;\nlet totalHits = 0;\nlet searchQuery = '';\nconst simpleLightBoxLightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nlet options = {\n  root: null,\n  rootMargin: '300px',\n  threshold: 1.0,\n};\nlet observer = new IntersectionObserver(onLoadInfinitiScroll, options);\n\nformSearchRef.addEventListener('submit', onSubmitSearch);\n\nfunction onSubmitSearch(event) {\n  event.preventDefault();\n\n  resetQuery();\n\n  searchQuery = event.target.elements.searchQuery.value.trim();\n  if (!searchQuery) {\n    return Notify.failure('Enter a search string');\n  }\n\n  fetchImages(searchQuery, currentPage, PER_PAGE)\n    .then(data => {\n      if (!data.hits.length & !data.totalHits) {\n        loadMoreRef.classList.add('is-hidden');\n        return Notify.failure(\n          'Sorry, there are no images matching your search query. Please try again.'\n        );\n      }\n      totalHits = data.totalHits;\n      if (currentPage === 1) {\n        Notify.success(`Hooray! We found ${totalHits} images.`);\n      }\n\n      renderGallery(data.hits);\n      simpleLightBoxLightbox.refresh();\n      observer.observe(target); // + for infiniti scroll\n\n      if (data.hits.length === data.totalHits) {\n        // 'zaz'\n        loadMoreRef.classList.add('is-hidden');\n        Notify.warning(\n          \"We're sorry, but you've reached the end of search results.\"\n        );\n      }\n      if (data.hits.length < data.totalHits) {\n        //loadMoreRef.classList.remove('is-hidden'); //- for Btn  loadMore\n      }\n    })\n    .catch(err => console.log(err));\n}\n\n// loadMoreRef.addEventListener('click', onLoad); //\n//\n// async function onLoad() {\n//   currentPage += 1;\n//   try {\n//     const data = await fetchImages(searchQuery, currentPage, PER_PAGE);\n//     renderGallery(data.hits);\n//     simpleLightBoxLightbox.refresh();\n//\n//     if (currentPage === Math.ceil(data.totalHits / PER_PAGE)) {\n//       loadMoreRef.classList.add('is-hidden');\n//       Notify.warning(\n//         \"We're sorry, but you've reached the end of search results.\"\n//       );\n//     } else {\n//       loadMoreRef.classList.remove('is-hidden'); // -\n//     }\n//     smoothScroll(galleryRef);\n//   } catch (err) {\n//     console.log(err);\n//   }\n// }\n\nfunction onLoadInfinitiScroll(entries, observer) {\n  entries.forEach(entry => {\n    if (entry.isIntersecting) {\n      currentPage += 1;\n      fetchImages(searchQuery, currentPage, PER_PAGE)\n        .then(data => {\n          renderGallery(data.hits);\n          simpleLightBoxLightbox.refresh();\n\n          if (currentPage === Math.ceil(data.totalHits / PER_PAGE)) {\n            loadMoreRef.classList.add('is-hidden');\n            Notify.warning(\n              \"We're sorry, but you've reached the end of search results.\"\n            );\n            observer.unobserve(target); // +\n          } else {\n            //loadMoreRef.classList.remove('is-hidden'); // -\n          }\n          smoothScroll(galleryRef);\n        })\n        .catch(err => console.log(err));\n    }\n  });\n}\n\nfunction renderGallery(dataArr) {\n  galleryRef.insertAdjacentHTML('beforeend', createMarkup(dataArr));\n}\n\nfunction resetQuery() {\n  galleryRef.innerHTML = '';\n  currentPage = 1;\n}\n"],"names":["$iQIUW","parcelRequire","$3b039bd7865ff738$var$formSearchRef","document","querySelector","$3b039bd7865ff738$var$galleryRef","$3b039bd7865ff738$var$loadMoreRef","$3b039bd7865ff738$var$target","$3b039bd7865ff738$var$currentPage","$3b039bd7865ff738$var$totalHits","$3b039bd7865ff738$var$searchQuery","$3b039bd7865ff738$var$simpleLightBoxLightbox","$parcel$interopDefault","$fZKcF","captionsData","captionDelay","$3b039bd7865ff738$var$observer","IntersectionObserver","entries","observer1","forEach","entry","isIntersecting","$klpux","fetchImages","then","data","$3b039bd7865ff738$var$renderGallery","hits","refresh","Math","ceil","totalHits","classList","add","Notify","warning","unobserve","$j6PhK","smoothScroll","catch","err","console","log","root","rootMargin","threshold","dataArr","insertAdjacentHTML","$2QAIP","createMarkup","addEventListener","event","preventDefault","innerHTML","$3b039bd7865ff738$var$resetQuery","target","elements","searchQuery","value","trim","failure","length","success","observe"],"version":3,"file":"02-hw11-pagination.0e10ef4a.js.map"}