{"mappings":"qhBAAA,IAAAA,EAAAC,EAAA,S,oDAOA,MAAMC,EAAgBC,SAASC,cAAc,gBACvCC,EAAaF,SAASC,cAAc,YACpCE,EAAcH,SAASC,cAAc,cAErCG,EAASJ,SAASC,cAAc,aAGtC,IAAII,EAAc,EACdC,EAAY,EACZC,EAAc,GAClB,MAAMC,EAAyB,IAAIC,EAAAC,GAAJ,CAAmB,aAAc,CAC9DC,aAAc,MACdC,aAAc,MAGhB,IAKIC,EAAW,IAAIC,sBA2InB,SAA8BC,EAASC,GACrCD,EAAQE,SAAQC,IACVA,EAAMC,iBACRd,GAAe,EAEfe,EAAQb,EAAaF,EA9JV,I,MASH,CACZgB,KAAM,KACNC,WAAY,QACZC,UAAW,IA0Eb,SAASH,EAAQI,EAAaC,EAAaC,IACzC,EAAAC,EAAAC,aAAYJ,EAAaC,EAAaC,GACnCG,MAAKC,IACJ,IAAKA,EAAKC,KAAKC,QAAUF,EAAKG,UAE5B,OADA9B,EAAY+B,UAAUC,IAAI,aACnBtC,EAAAuC,OAAOC,QACZ,4EAyFV,IAAuBC,EAtFjBhC,EAAYwB,EAAKG,UACG,IAAhBR,GACF5B,EAAAuC,OAAOG,QAAQ,oBAAoBjC,aAoFpBgC,EAjFHR,EAAKC,KAkFvB7B,EAAWsC,mBAAmB,aAAa,EAAAC,EAAAC,cAAaJ,IAjFpD9B,EAAuBmC,UACvB9B,EAAS+B,QAAQxC,GAEb0B,EAAKC,KAAKC,SAAWF,EAAKG,YAE5B9B,EAAY+B,UAAUC,IAAI,aAC1BtC,EAAAuC,OAAOS,QACL,+DAGAf,EAAKC,KAAKC,OAASF,EAAKG,UAIxBR,IAAgBqB,KAAKC,KAAKjB,EAAKG,UAAYP,KAC7CvB,EAAY+B,UAAUC,IAAI,aAC1BtC,EAAAuC,OAAOS,QACL,8DAEFhC,EAASmC,UAAU5C,KAIrB,EAAA6C,EAAAC,cAAahD,EAAW,IAGzBiD,OAAMC,GAAOC,QAAQC,IAAIF,I,EA/GhB,CACZG,QAASvD,SAASC,cAAc,WAChCuD,OACEC,KAAKF,QAAQG,QAAS,C,EAExBC,OACEF,KAAKF,QAAQG,QAAS,C,EAExBE,mBACEC,OAAOD,iBAAiB,UAAU,MAChBC,OAAOC,SAAW9D,SAAS+D,gBAAgBC,WACjD,IAAMP,KAAKD,OAASC,KAAKE,MAAM,IAE3C3D,SAASC,cAAc,WAAWgE,QAAU,KAC1CJ,OAAOK,SAAS,CACdC,IAAK,EACLC,KAAM,EACNC,SAAU,UACV,C,IAKFT,mBAEN7D,EAAc6D,iBAAiB,UAE/B,SAAwBU,GAMtB,GALAA,EAAMC,iBA6IR,WACErE,EAAWsE,UAAY,GACvBnE,EAAc,C,CA7IdoE,GAEAlE,EAAc+D,EAAMI,OAAOC,SAASC,YAAYC,MAAMC,QACjDvE,EACH,OAAOV,EAAAuC,OAAOC,QAAQ,yBAGxBjB,EAAQb,EAAaF,EArDN,G","sources":["src/03-index.js"],"sourcesContent":["import { Notify } from 'notiflix/build/notiflix-notify-aio';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { fetchImages } from './js/pixabayAPI';\nimport { createMarkup } from './js/createCards';\nimport { smoothScroll } from './js/setScroll';\n\nconst formSearchRef = document.querySelector('.search-form');\nconst galleryRef = document.querySelector('.gallery');\nconst loadMoreRef = document.querySelector('.load-more');\n// + for infiniti scroll\nconst target = document.querySelector('.js-guard');\n\nconst PER_PAGE = 40;\nlet currentPage = 1;\nlet totalHits = 0;\nlet searchQuery = '';\nconst simpleLightBoxLightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nlet options = {\n  root: null,\n  rootMargin: '300px',\n  threshold: 1.0,\n};\nlet observer = new IntersectionObserver(onLoadInfinitiScroll, options);\n\nconst btnUp = {\n  element: document.querySelector('.btn-up'),\n  show() {\n    this.element.hidden = false;\n  },\n  hide() {\n    this.element.hidden = true;\n  },\n  addEventListener() {\n    window.addEventListener('scroll', () => {\n      const scrollY = window.scrollY || document.documentElement.scrollTop;\n      scrollY > 500 ? this.show() : this.hide();\n    });\n    document.querySelector('.btn-up').onclick = () => {\n      window.scrollTo({\n        top: 0,\n        left: 0,\n        behavior: 'smooth',\n      });\n    };\n  },\n};\n\nbtnUp.addEventListener();\n\nformSearchRef.addEventListener('submit', onSubmitSearch);\n\nfunction onSubmitSearch(event) {\n  event.preventDefault();\n\n  resetQuery();\n\n  searchQuery = event.target.elements.searchQuery.value.trim();\n  if (!searchQuery) {\n    return Notify.failure('Enter a search string');\n  }\n\n  getData(searchQuery, currentPage, PER_PAGE);\n  // move to getDate()\n  //   fetchImages(searchQuery, currentPage, PER_PAGE)\n  //     .then(data => {\n  //       if (!data.hits.length & !data.totalHits) {\n  //         loadMoreRef.classList.add('is-hidden');\n  //         return Notify.failure(\n  //           'Sorry, there are no images matching your search query. Please try again.'\n  //         );\n  //       }\n  //       totalHits = data.totalHits;\n  //       if (currentPage === 1) {\n  //         Notify.success(`Hooray! We found ${totalHits} images.`);\n  //       }\n\n  //       renderGallery(data.hits);\n  //       simpleLightBoxLightbox.refresh();\n  //       observer.observe(target); // + for infiniti scroll\n\n  //       if (data.hits.length === data.totalHits) {\n  //         // 'zaz'\n  //         loadMoreRef.classList.add('is-hidden');\n  //         Notify.warning(\n  //           \"We're sorry, but you've reached the end of search results.\"\n  //         );\n  //       }\n  //       if (data.hits.length < data.totalHits) {\n  //         //loadMoreRef.classList.remove('is-hidden'); //- for Btn  loadMore\n  //       }\n  //     })\n  //     .catch(err => console.log(err));\n}\n\nfunction getData(searchQuery, currentPage, PER_PAGE) {\n  fetchImages(searchQuery, currentPage, PER_PAGE)\n    .then(data => {\n      if (!data.hits.length & !data.totalHits) {\n        loadMoreRef.classList.add('is-hidden');\n        return Notify.failure(\n          'Sorry, there are no images matching your search query. Please try again.'\n        );\n      }\n      totalHits = data.totalHits;\n      if (currentPage === 1) {\n        Notify.success(`Hooray! We found ${totalHits} images.`);\n      }\n\n      renderGallery(data.hits);\n      simpleLightBoxLightbox.refresh();\n      observer.observe(target); // + for infiniti scroll\n\n      if (data.hits.length === data.totalHits) {\n        // 'zaz'\n        loadMoreRef.classList.add('is-hidden');\n        Notify.warning(\n          \"We're sorry, but you've reached the end of search results.\"\n        );\n      }\n      if (data.hits.length < data.totalHits) {\n        //loadMoreRef.classList.remove('is-hidden'); //- for Btn  loadMore\n      }\n      // -2 load\n      if (currentPage === Math.ceil(data.totalHits / PER_PAGE)) {\n        loadMoreRef.classList.add('is-hidden');\n        Notify.warning(\n          \"We're sorry, but you've reached the end of search results.\"\n        );\n        observer.unobserve(target); // +\n      } else {\n        //loadMoreRef.classList.remove('is-hidden'); // -\n      }\n      smoothScroll(galleryRef);\n      //\n    })\n    .catch(err => console.log(err));\n}\n\n// loadMoreRef.addEventListener('click', onLoad); //\n//\n// async function onLoad() {\n//   currentPage += 1;\n//   try {\n//     const data = await fetchImages(searchQuery, currentPage, PER_PAGE);\n//     renderGallery(data.hits);\n//     simpleLightBoxLightbox.refresh();\n//\n//     if (currentPage === Math.ceil(data.totalHits / PER_PAGE)) {\n//       loadMoreRef.classList.add('is-hidden');\n//       Notify.warning(\n//         \"We're sorry, but you've reached the end of search results.\"\n//       );\n//     } else {\n//       loadMoreRef.classList.remove('is-hidden'); // -\n//     }\n//     smoothScroll(galleryRef);\n//   } catch (err) {\n//     console.log(err);\n//   }\n// }\n\nfunction onLoadInfinitiScroll(entries, observer) {\n  entries.forEach(entry => {\n    if (entry.isIntersecting) {\n      currentPage += 1;\n\n      getData(searchQuery, currentPage, PER_PAGE);\n      // move to getDate()\n      //   fetchImages(searchQuery, currentPage, PER_PAGE)\n      //     .then(data => {\n      //       renderGallery(data.hits);\n      //       simpleLightBoxLightbox.refresh();\n\n      //       if (currentPage === Math.ceil(data.totalHits / PER_PAGE)) {\n      //         loadMoreRef.classList.add('is-hidden');\n      //         Notify.warning(\n      //           \"We're sorry, but you've reached the end of search results.\"\n      //         );\n      //         observer.unobserve(target); // +\n      //       } else {\n      //         //loadMoreRef.classList.remove('is-hidden'); // -\n      //       }\n      //       smoothScroll(galleryRef);\n      //     })\n      //     .catch(err => console.log(err));\n    }\n  });\n}\n\nfunction renderGallery(dataArr) {\n  galleryRef.insertAdjacentHTML('beforeend', createMarkup(dataArr));\n}\n\nfunction resetQuery() {\n  galleryRef.innerHTML = '';\n  currentPage = 1;\n}\n"],"names":["$iQIUW","parcelRequire","$519f4c98a9dc5d95$var$formSearchRef","document","querySelector","$519f4c98a9dc5d95$var$galleryRef","$519f4c98a9dc5d95$var$loadMoreRef","$519f4c98a9dc5d95$var$target","$519f4c98a9dc5d95$var$currentPage","$519f4c98a9dc5d95$var$totalHits","$519f4c98a9dc5d95$var$searchQuery","$519f4c98a9dc5d95$var$simpleLightBoxLightbox","$parcel$interopDefault","$fZKcF","captionsData","captionDelay","$519f4c98a9dc5d95$var$observer","IntersectionObserver","entries","observer","forEach","entry","isIntersecting","$519f4c98a9dc5d95$var$getData","root","rootMargin","threshold","searchQuery1","currentPage1","PER_PAGE1","$klpux","fetchImages","then","data","hits","length","totalHits","classList","add","Notify","failure","dataArr","success","insertAdjacentHTML","$2QAIP","createMarkup","refresh","observe","warning","Math","ceil","unobserve","$j6PhK","smoothScroll","catch","err","console","log","element","show","this","hidden","hide","addEventListener","window","scrollY","documentElement","scrollTop","onclick","scrollTo","top","left","behavior","event","preventDefault","innerHTML","$519f4c98a9dc5d95$var$resetQuery","target","elements","searchQuery","value","trim"],"version":3,"file":"03-hw11-pagination.f282cbe8.js.map"}