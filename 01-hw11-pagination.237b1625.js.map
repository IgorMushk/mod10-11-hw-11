{"mappings":"iiBAAA,IAAAA,EAAAC,EAAA,S,4EAOA,IAAMC,EAAgBC,SAASC,cAAc,gBACvCC,EAAaF,SAASC,cAAc,YACpCE,EAAcH,SAASC,cAAc,cAKvCG,GAHWJ,SAASC,cAAc,aAGpB,GACdI,EAAY,EACZC,EAAc,GACZC,EAAyB,IAAIC,EAAAC,GAAJ,CAAmB,aAAc,CAC9DC,aAAc,MACdC,aAAc,M,SAgFDC,I,OAAAA,EAAfJ,EAAAX,EAAA,CAAAW,EAAAK,GAAAC,MAAA,SAAAC,I,IAGUC,E,yEAFRZ,GAAe,E,mBAEM,EAAAa,EAAAC,aAAYZ,EAAaF,EAzF/B,I,OA0Fbe,GADMH,EAAII,EAAAC,MACSC,MACnBf,EAAuBgB,UAEnBnB,IAAgBoB,KAAKC,KAAKT,EAAKU,UA7FtB,KA8FXvB,EAAYwB,UAAUC,IAAI,aAC1BC,EAAAC,OAAOC,QACL,+DAGF5B,EAAYwB,UAAUK,OAAO,a,kDAI/BC,QAAQC,IAAGd,EAAAe,I,2DAjBMC,MAAAC,KAAAC,U,CA8CrB,SAASnB,EAAcoB,GACrBrC,EAAWsC,mBAAmB,aAAa,EAAAC,EAAAC,cAAaH,G,EArH5C,CACZI,QAAS3C,SAASC,cAAc,WAChC2C,KAAA,WACEP,KAAKM,QAAQE,QAAS,C,EAExBC,KAAA,WACET,KAAKM,QAAQE,QAAS,C,EAExBE,iBAAA,W,WACEC,OAAOD,iBAAiB,UAAU,YAChBC,OAAOC,SAAWjD,SAASkD,gBAAgBC,WACjD,IAAMC,EAAKR,OAASQ,EAAKN,M,IAErC9C,SAASC,cAAc,WAAWoD,QAAU,WAC1CL,OAAOM,SAAS,CACdC,IAAK,EACLC,KAAM,EACNC,SAAU,U,KAMZV,mBAENhD,EAAcgD,iBAAiB,UAE/B,SAAwBW,GAMtB,GALAA,EAAMC,iBA4FR,WACEzD,EAAW0D,UAAY,GACvBxD,EAAc,C,CA5FdyD,KAEAvD,EAAcoD,EAAMI,OAAOC,SAASC,YAAYC,MAAMC,QAEpD,OAAOrC,EAAAC,OAAOqC,QAAQ,0BAGxB,EAAAlD,EAAAC,aAAYZ,EAAaF,EArDV,IAsDZgE,MAAK,SAAApD,GACJ,IAAKA,EAAKM,KAAK+C,QAAUrD,EAAKU,UAE5B,OADAvB,EAAYwB,UAAUC,IAAI,aACnBC,EAAAC,OAAOqC,QACZ,4EAGJ9D,EAAYW,EAAKU,UACG,IAAhBtB,GACFyB,EAAAC,OAAOwC,QAAQ,oBAA8BC,OAAVlE,EAAU,aAG/Cc,EAAcH,EAAKM,MACnBf,EAAuBgB,UAGnBP,EAAKM,KAAK+C,SAAWrD,EAAKU,YAE5BvB,EAAYwB,UAAUC,IAAI,aAC1BC,EAAAC,OAAOC,QACL,+DAGAf,EAAKM,KAAK+C,OAASrD,EAAKU,WAC1BvB,EAAYwB,UAAUK,OAAO,Y,IAGhCwC,OAAM,SAAAC,G,OAAOxC,QAAQC,IAAIuC,E,OAG9BtE,EAAY4C,iBAAiB,S,kBAEdnC,EAAMwB,MAAAC,KAAAC,U","sources":["src/01-index.js"],"sourcesContent":["import { Notify } from 'notiflix/build/notiflix-notify-aio';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { fetchImages } from './js/pixabayAPI';\nimport { createMarkup } from './js/createCards';\nimport { smoothScroll } from './js/setScroll';\n\nconst formSearchRef = document.querySelector('.search-form');\nconst galleryRef = document.querySelector('.gallery');\nconst loadMoreRef = document.querySelector('.load-more');\n// + for infiniti scroll\nconst target = document.querySelector('.js-guard');\n\nconst PER_PAGE = 40;\nlet currentPage = 1;\nlet totalHits = 0;\nlet searchQuery = '';\nconst simpleLightBoxLightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\n// let options = {\n//   root: null,\n//   rootMargin: '300px',\n//   threshold: 1.0,\n// };\n// let observer = new IntersectionObserver(onLoadInfinitiScroll, options);\n\nconst btnUp = {\n  element: document.querySelector('.btn-up'),\n  show() {\n    this.element.hidden = false;\n  },\n  hide() {\n    this.element.hidden = true;\n  },\n  addEventListener() {\n    window.addEventListener('scroll', () => {\n      const scrollY = window.scrollY || document.documentElement.scrollTop;\n      scrollY > 500 ? this.show() : this.hide();\n    });\n    document.querySelector('.btn-up').onclick = () => {\n      window.scrollTo({\n        top: 0,\n        left: 0,\n        behavior: 'smooth',\n      });\n    };\n  },\n};\n\nbtnUp.addEventListener();\n\nformSearchRef.addEventListener('submit', onSubmitSearch);\n\nfunction onSubmitSearch(event) {\n  event.preventDefault();\n\n  resetQuery();\n\n  searchQuery = event.target.elements.searchQuery.value.trim();\n  if (!searchQuery) {\n    return Notify.failure('Enter a search string');\n  }\n\n  fetchImages(searchQuery, currentPage, PER_PAGE)\n    .then(data => {\n      if (!data.hits.length & !data.totalHits) {\n        loadMoreRef.classList.add('is-hidden');\n        return Notify.failure(\n          'Sorry, there are no images matching your search query. Please try again.'\n        );\n      }\n      totalHits = data.totalHits;\n      if (currentPage === 1) {\n        Notify.success(`Hooray! We found ${totalHits} images.`);\n      }\n\n      renderGallery(data.hits);\n      simpleLightBoxLightbox.refresh();\n      //observer.observe(target); // + for infiniti scroll\n\n      if (data.hits.length === data.totalHits) {\n        // 'zaz'\n        loadMoreRef.classList.add('is-hidden');\n        Notify.warning(\n          \"We're sorry, but you've reached the end of search results.\"\n        );\n      }\n      if (data.hits.length < data.totalHits) {\n        loadMoreRef.classList.remove('is-hidden'); //- for Btn  loadMore\n      }\n    })\n    .catch(err => console.log(err));\n}\n\nloadMoreRef.addEventListener('click', onLoad); //\n\nasync function onLoad() {\n  currentPage += 1;\n  try {\n    const data = await fetchImages(searchQuery, currentPage, PER_PAGE);\n    renderGallery(data.hits);\n    simpleLightBoxLightbox.refresh();\n\n    if (currentPage === Math.ceil(data.totalHits / PER_PAGE)) {\n      loadMoreRef.classList.add('is-hidden');\n      Notify.warning(\n        \"We're sorry, but you've reached the end of search results.\"\n      );\n    } else {\n      loadMoreRef.classList.remove('is-hidden'); // -\n    }\n    // smoothScroll(galleryRef);\n  } catch (err) {\n    console.log(err);\n  }\n}\n\n// function onLoadInfinitiScroll(entries, observer) {\n//   entries.forEach(entry => {\n//     if (entry.isIntersecting) {\n//       currentPage += 1;\n//       fetchImages(searchQuery, currentPage, PER_PAGE)\n//         .then(data => {\n//           renderGallery(data.hits);\n//           simpleLightBoxLightbox.refresh();\n//\n//           if (currentPage === Math.ceil(data.totalHits / PER_PAGE)) {\n//             loadMoreRef.classList.add('is-hidden');\n//             Notify.warning(\n//               \"We're sorry, but you've reached the end of search results.\"\n//             );\n//             observer.unobserve(target); // +\n//           } else {\n//             //loadMoreRef.classList.remove('is-hidden'); // -\n//           }\n//           smoothScroll(galleryRef);\n//         })\n//         .catch(err => console.log(err));\n//     }\n//   });\n// }\n\nfunction renderGallery(dataArr) {\n  galleryRef.insertAdjacentHTML('beforeend', createMarkup(dataArr));\n}\n\nfunction resetQuery() {\n  galleryRef.innerHTML = '';\n  currentPage = 1;\n}\n"],"names":["$bpxeT","parcelRequire","$07eb150d622544d8$var$formSearchRef","document","querySelector","$07eb150d622544d8$var$galleryRef","$07eb150d622544d8$var$loadMoreRef","$07eb150d622544d8$var$currentPage","$07eb150d622544d8$var$totalHits","$07eb150d622544d8$var$searchQuery","$07eb150d622544d8$var$simpleLightBoxLightbox","$parcel$interopDefault","$5IjG7","captionsData","captionDelay","$07eb150d622544d8$var$_onLoad","$2TvXO","mark","_callee","data","$dmKTG","fetchImages","$07eb150d622544d8$var$renderGallery","_ctx","sent","hits","refresh","Math","ceil","totalHits","classList","add","$h6c0i","Notify","warning","remove","console","log","t0","apply","this","arguments","dataArr","insertAdjacentHTML","$8QEe8","createMarkup","element","show","hidden","hide","addEventListener","window","scrollY","documentElement","scrollTop","_this","onclick","scrollTo","top","left","behavior","event","preventDefault","innerHTML","$07eb150d622544d8$var$resetQuery","target","elements","searchQuery","value","trim","failure","then","length","success","concat","catch","err"],"version":3,"file":"01-hw11-pagination.237b1625.js.map"}